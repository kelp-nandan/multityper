<div class="dashboard-container">
  <!-- Logout button -->
  <button class="logout-btn" (click)="onLogout()" title="Logout">
    <svg
      xmlns="http://www.w3.org/2000/svg"
      width="20"
      height="20"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
      <polyline points="16,17 21,12 16,7"></polyline>
      <line x1="21" y1="12" x2="9" y2="12"></line>
    </svg>
    Logout
  </button>

  <div class="welcome-dashboard-container">
    <div class="header-row">
      <div class="profile">
        <div class="avatar">{{ (user()?.name || 'U').charAt(0) }}</div>
        <div class="user-info">
          <div class="user-name">{{ user()?.name || 'User' }}</div>
          <div class="user-email">{{ user()?.email || '' }}</div>
        </div>
      </div>
      <div class="controls">
        <button class="create-button" (click)="createRoomModal()">Create Room</button>
        <button class="join-button" (click)="joinRoomModal()">Join Room</button>
      </div>
    </div>

    <h1 class="welcome-note">
      <span class="wel-text">Welcome,</span> {{ user()?.name || 'User' }}
    </h1>
    <p class="subtitle">Type fast. Think faster. Win the race.</p>

    <div class="stats-row">
      <div class="stat">
        <div class="stat-value">0</div>
        <div class="stat-label">Best WPM</div>
      </div>
      <div class="stat">
        <div class="stat-value">0</div>
        <div class="stat-label">Games Played</div>
      </div>
      <div class="stat">
        <div class="stat-value">0</div>
        <div class="stat-label">Wins</div>
      </div>
    </div>
  </div>
</div>

<app-modal
  [isOpen]="showJoinModal()"
  [showFooter]="false"
  (onClose)="handleJoinClose()"
  title="Join Room"
>
  <div class="modal-content rooms-list">
    <div class="rooms-intro">Select a room to join â€” tap Join on the right.</div>

    @for (room of rooms$ | async; track trackByRoomId($index, room)) {
      <div class="room-card">
        <div class="room-info">
          <p class="room-name">{{ room.data.roomName }}</p>
          <p class="room-id">
            ID: <span>{{ room.key }}</span>
          </p>
        </div>

        <button class="room-join-btn" (click)="handleJoinRoom(room)">Join</button>
      </div>
    }
  </div>
</app-modal>

<app-modal
  [isOpen]="showCreateModal()"
  title="Create New Room"
  (onClose)="handleCreateClose()"
  (onConfirmed)="handleCreateConfirm()"
>
  <div class="modal-content create-room">
    <label for="roomName">Room name</label>
    <input
      type="text"
      id="roomName"
      placeholder="Enter your room name"
      [ngModel]="roomName()"
      (ngModelChange)="roomName.set($event)"
      class="modal-input"
    />
    <p class="hint">Give your room a fun, memorable name so friends can find it.</p>
  </div>
</app-modal>
